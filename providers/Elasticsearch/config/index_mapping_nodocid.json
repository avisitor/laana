{
  "settings": {
    "analysis": {
      "char_filter": {
        "remove_okina": {
          "type": "mapping",
          "mappings": ["Ê»=>"]
        }
      },
      "analyzer": {
        "folding_analyzer": {
          "tokenizer": "standard",
          "filter": ["lowercase", "asciifolding"],
          "char_filter": ["remove_okina"]
        }
      }
    }
  },
  "mappings": {
    "_meta": {
      "model": "intfloat/multilingual-e5-small",
      "version": "1.3.0",
      "description": "Hawaiian language corpus with chunk-based regex support for long documents and folding analyzer for diacritic-insensitive search.",
      "changelog": [
        "1.1.0: Added regex support via text.raw field",
        "1.2.0: Added text_chunks for documents >32K characters, enabling full regex on any length document",
          "1.3.0: Added folding_analyzer for diacritic-insensitive search",
          "1.4.0: No doc_id, use the sourceid as native _id"
      ]
    },
    "properties": {
      "groupname": {"type": "keyword"},
      "sourcename": {"type": "keyword"},
      "date": {"type": "date"},
      "authors": {"type": "keyword"},
      "link": {"type": "keyword"},
      "hawaiian_word_ratio": {"type": "float"},
      "text": {
        "type": "text",
        "fields": {
          "keyword": {"type": "keyword", "ignore_above": 256},
          "wildcard": {"type": "wildcard"},
          "raw": {"type": "keyword", "store": true, "doc_values": true, "ignore_above": 50000},
          "folded": {"type": "text", "analyzer": "folding_analyzer"}
        }
      },
      "text_chunks": {
        "type": "nested",
        "properties": {
          "chunk_index": {"type": "integer"},
          "chunk_text": {
            "type": "text",
            "fields": {
              "raw": {"type": "keyword", "store": true, "doc_values": true, "ignore_above": 50000},
              "wildcard": {"type": "wildcard"},
              "folded": {"type": "text", "analyzer": "folding_analyzer"}
            }
          },
          "chunk_start": {"type": "integer"},
          "chunk_length": {"type": "integer"}
        }
      },
      "text": {"type": "wildcard"},
      "text_vector": {"type": "dense_vector", "index": true, "similarity": "cosine"},
      "sentences": {
        "type": "nested",
        "properties": {
          "text": {
            "type": "text",
            "fields": {
              "wildcard": {"type": "wildcard"},
              "raw": {"type": "keyword", "store": true, "doc_values": true, "ignore_above": 50000},
              "folded": {"type": "text", "analyzer": "folding_analyzer"}
            }
          },
          "position": {"type": "integer"},
          "vector": {"type": "dense_vector", "index": true, "similarity": "cosine"}
        }
      }
    }
  }
}
